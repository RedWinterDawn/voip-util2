<link rel="stylesheet" href="menu.css">
<script type="text/javascript" src="js/featurerequest.js"></script>
<?php

$conn = pg_connect("host=172.25.9.34 dbname=sshkeys user=sshkeys")
    $query = "SELECT count(*) FROM featurerequest;";
    $result = pg_query($conn, $query);
    $row = pg_fetch_array($result, null, PGSQL_ASSOC);
    $total_rows = $row['count'];
    $rpp = 10;
    $last = ceil($total_rows/$rpp);
    if($last < 1) {
          $last = 1;
          }
?>
<script>
var rpp = <?php echo $rpp; ?>; // results per page
var last = <?php echo $last; ?>; // last page number
function request_page(pn){
  var results_box = document.getElementById("results_box");
  var pagination_controls = document.getElementById("pagination_controls");
  results_box.innerHTML = "loading results ...";
  var hr = new XMLHttpRequest();
    hr.open("POST", "pagination_parser.php", true);
    hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    hr.onreadystatechange = function() {
      if(hr.readyState == 4 && hr.status == 200) {
      var dataArray = hr.responseText.split("||");
      var html_output = "";
      var k = 1;
        for(i = 0; i < dataArray.length - 1; i++){
        var itemArray = dataArray[i].split("|");
        html_output += k+" - "+itemArray[1]+" - "+itemArray[2]+"</b><hr>";
        k++;
      }
      results_box.innerHTML = html_output;
      }
    }
    hr.send("rpp="+rpp+"&last="+last+"&pn="+pn);
  // Change the pagination controls
  var paginationCtrls = "";
    // Only if there is more than 1 page worth of results give the user pagination controls
    if(last != 1){
    if (pn > 1) {
      paginationCtrls += '<button onclick="request_page('+(pn-1)+')">&lt;</button>';
      }
    paginationCtrls += ' &nbsp; &nbsp; <b>Page '+pn+' of '+last+'</b> &nbsp; &nbsp; ';
      if (pn != last) {
          paginationCtrls += '<button onclick="request_page('+(pn+1)+')">&gt;</button>';
      }
    }
  pagination_controls.innerHTML = paginationCtrls;
}

</script>





<ul class="jmenu">
	<li><a href="index.php">Main</a>
		<ul>
			<li><a href="index.php">Main</a></li>
		</ul>
	</li>
	<li><a href="#">Customers</a>
		<ul>
			<li><a href="simple-migration.php">Move 1 Domain</a></li>
			<li><a href="mass-exodus.php">Mass Exodus</a></li>
			<li><a href="pbx-presence-vip-list.php">VIP List</a></li>
			<li><a href="domain-info.php?domain=jive">Customer Info</a></li>
			<li><a href="customer-call-report.php">Call Report</a></li>
			<li><a href="http://cdrtool.devops.jive.com">CDR CSV Download</a></li>
      <li><a href="sherlockiso.php">Sherlock ISO Codes</a></li>
      <li><a href="sshkeys.php">Key Manager</a></li>
      <li><a href="recording.php">Rec Manager</a></li>
		</ul>
	</li>
	<li><a href="#">v5</a>
	  <ul>
			<li><a href="v5-migration.php">v5 Migration</a></li>
			<li><a href="http://prodtools.devops.jive.com/v5_migration_status.php">v5 Migration Status</a></li>
			<li><a href="sensitive.php">Sensitives</a></li>
	  </ul>
	</li>
	<li><a href="events-report.php">Events</a>
		<ul>
			<li><a href="events-report.php">Events Report</a></li>
			<li><a href="top_events.php">Top Events</a></li>
		</ul>
	</li>
	<li><a href="pbx-availability.php">PBX Nodes</a>
		<ul>
			<li><a href="pbx-availability.php">Availability</a></li>
			<li><a href="moar-pbx.php">Moar Pbx</a></li>
			<li><a href="pbx-state.php">State</a></li>
		</ul>
	</li>
	<li><a href="ebc-status.php">EBC</a>
		<ul>
			<li><a href="ebc-status.php">EBC Status</a></li>
		</ul>
    </li>
	<li><a href="#">Informational</a>
		<ul>
			<li><a href="http://icalls.devops.jive.com">iCalls</a></li>
			<li><a href="cost-check.php">LCR Lookup</a></li>
			<li><a href="mpls-info.php">MPLS Info</a></li>
			<li><a href="peer.php">v4 Peer Info</a></li>
			<li><a href="phone-model-count.php">Phone Count</a></li>
			<li><a href="site-info.php">Site Info</a></li>
			<li><a href="did-info.php?did=9996660000">DID Info</a></li>
			<li><a href="links.html">Links</a></li>
			<li><a href="https://10.101.17.1/balancer-manager">C1 WB1 balancer manager</a></li>
			<li><a href="https://10.101.17.1/jive-monitor">C1 WB1 Apache Status</a></li>
			<li><a href="lcr-test.php?site=ORD">LCR Validator Tester</a></li>
			<li><a href="enterprise.html">Enterprisify</a></li>
			<li><a href="waVersion.php">WA/AGI Info</a></li>
      <li><a href="ping.html">Network Utility</a></li>
		</ul>
	</li>
	<li><a href="#">CTC</a>
		<ul>
			<li><a href="http://ctc.devops.jive.com">Inbound Controller</a></li>
			<li><a href="http://ctc.devops.jive.com/edit_number.php">Manage Numbers</a></li>
		</ul>
	</li>
	<li><a href="#">SBC</a>
		<ul>
			<li><a href="sbc-trunkgroup.php">Customer SIP Trunk Groups</a></li>
			<li><a href="sbc-trunk.php">Customer SIP Trunks</a></li>
		</ul>
	</li>
	<li><a href="#">SmokePing</a>
		<ul>
			<li><a href="http://smokeping.devops.jive.com/chi-1a/cgi-bin/smokeping.fcgi">CHI</a></li>
			<li><a href="http://smokeping.devops.jive.com/atl-1a/cgi-bin/smokeping.fcgi">ATL</a></li>
			<li><a href="http://smokeping.devops.jive.com/lax-1a/cgi-bin/smokeping.fcgi">LAX</a></li>
			<li><a href="http://smokeping.devops.jive.com/nyc-1a/cgi-bin/smokeping.fcgi">NYC</a></li>
			<li><a href="http://smokeping.devops.jive.com/pvu-1a/cgi-bin/smokeping.fcgi">PVU</a></li>
		</ul>
	</li>
  <li><a href="https://10.132.0.224/xymon/">Xymon</a>
    <ul>
      <li><a href="https://10.132.0.224/xymon/">OPS (All Sites)</a></li>
      <li><a href="https://162.250.62.224/xymon/">ATL</a></li>
      <li><a href="https://199.36.251.224/xymon/">DFW</a></li>
      <li><a href="https://162.250.63.224/xymon/">GEG</a></li>
      <li><a href="https://162.250.60.224/xymon/">LAX</a></li>
      <li><a href="https://199.87.122.224/xymon/">LON</a></li>
      <li><a href="https://162.250.61.224/xymon/">NYC</a></li>
      <li><a href="https://199.87.123.224/xymon/">PVU</a></li>
    </ul>
  </li>
  <li><a href="#">DB</a>
    <ul>
      <li><a href="rodb-check.php?ip=10.101.4.1">CHI RODB</a></li>
      <li><a href="rodb-check.php?ip=10.101.4.2">CHI RWDB</a></li>
    </ul>
  </li>
</ul>
<div id="feature-request" onclick="toggle_visibility('popup-feature');">FR</div>
<form method="post" action="<?php $_PHP_SELF ?>" id="feature-requester-form">
  <input type="hidden" id="feature-requester" name="feature-requester" />
</form>

<?php

$featuser =  $_SERVER["PHP_AUTH_USER"];
$feature = $_POST['feature-requester'];
if($feature != NULL) {
$conn = pg_connect("host=172.25.9.34 dbname=sshkeys user=sshkeys")
  or die('Could not connect: ' . pg_last_error());
  $query = "INSERT INTO featurerequest (username, feature) VALUES ('".$featuser."', '".$feature."')";
      $result = pg_query($conn, $query);
  }
  ?>
<br><br>
